{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>StudyMaster - A Website for Better Study</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f0f5ff;
            color: #c7c7c7;
            text-align: center;
            background-image: url('images/bg.jpg');
            background-size: 500px 500px ;
        }
        
        
        h1 {
            
            font-family:Impact, Haettenschweiler, 'Arial Narrow', sans-serif;
            color: rgb(61, 83, 163);
            text-align: center;
            font-size: 60px;
            letter-spacing: 2px;
        }
        
        sub {
            font-size: 70%;
        }
        
        .content {
            background-color: rgba(57, 73, 132, 0.753);
            border-radius: 50px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            margin-top: 20px;
        }
        
        .main-links {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 20px 0;
        }
        
        .main-links a {
            font-size: 28px;
            color: #2980b9;
            text-decoration: none;
            margin: 15px 0;
            transition: color 0.3s ease;
            padding: 10px 20px;
            border-radius: 20px;
            background-color: #f5f9ff;
            width: 80%;
        }
        
        .main-links a:hover {
            color: #1c5980;
            background-color: #e6efff;
        }
        
        hr {
            margin: 30px 0;
            border: 0;
            border-top: 1px solid #ccc;
        }
        
        .about-link {
            text-align: right;
        }
        
        .about-link a {
            font-size: 120%;
            color: #c4e0f3;
            text-decoration: none;
            transition: color 0.3s ease;
        }
        
        .about-link a:hover {
            color: #00ffbf;
        }
        
        /* Progress bar styles */
        .progress-container {
            margin: 30px 0;
            text-align: center;
        }
        
        .progress-bar {
            width: 100%;
            background-color: #e0e8ff;
            border-radius: 4px;
            height: 35px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background-color: #1a5fb4;
            width: 0%;
            transition: width 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }
        
        .timer-container {
            text-align: center;
            margin: 20px 0;
            font-size: 24px;
        }
    </style>
</head>
<body>
   
    <i><h1>StudyMaster<sub>- Your Study Companion</sub></h1></i>
    
    <div class="content">
        <div class="timer-container">
            <div>Time spent today: <span id="timeSpent">0:00:00</span></div>
        </div>
        
        <div class="progress-container">
            <h2>Your Progress</h2>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill">0%</div>
            </div>
        </div>
        
        <div class="main-links">
            <a href="{% url 'ss' %}"><b>Study Strategies</b></a>
            <a href="{% url 'learn' %}"><b>Learn</b></a>
            <a href="{% url 'Timer' %}"><b>Timer</b></a>
            <a href="{% url 'Progress' %}"><b>Progress</b></a>
        </div>
        
        <hr>
        
        <div class="about-link">
            <a href="{% url 'about' %}">About Us</a>
        </div>
    </div>

    <script>
        // TIMER CODE - This code must be included on all pages of your website
        // -----------------------------------------------------------------------
        // TIME TRACKING - START
        
        // Consistent key for website-wide timer
        const WEBSITE_TIMER_KEY = 'websiteTimerData';
        
        // Time tracking variables
        let startTime = new Date();
        let totalSeconds = 0;
        
        // Initialize timer function
        function initTimer() {
            const today = new Date().toLocaleDateString();
            let savedTimerData = JSON.parse(localStorage.getItem(WEBSITE_TIMER_KEY) || '{}');
            
            // Check if we have data for today
            if (savedTimerData.date === today) {
                totalSeconds = savedTimerData.timeSpent || 0;
            } else {
                // New day, reset timer
                savedTimerData = {
                    date: today,
                    timeSpent: 0
                };
                localStorage.setItem(WEBSITE_TIMER_KEY, JSON.stringify(savedTimerData));
            }
            
            // Update display immediately
            updateTimerDisplay();
            
            // Start the timer
            setInterval(updateTimer, 1000);
        }
        
        // Update timer function
        function updateTimer() {
            const now = new Date();
            const diffSeconds = Math.floor((now - startTime) / 1000);
            totalSeconds += diffSeconds;
            startTime = now;
            
            // Save to localStorage
            const today = new Date().toLocaleDateString();
            const savedTimerData = JSON.parse(localStorage.getItem(WEBSITE_TIMER_KEY) || '{}');
            savedTimerData.date = today;
            savedTimerData.timeSpent = totalSeconds;
            localStorage.setItem(WEBSITE_TIMER_KEY, JSON.stringify(savedTimerData));
            
            // Update display
            updateTimerDisplay();
        }
        
        // Update the display
        function updateTimerDisplay() {
            const hours = Math.floor(totalSeconds / 3600);
            const minutes = Math.floor((totalSeconds % 3600) / 60);
            const seconds = totalSeconds % 60;
            
            const formattedTime = `${hours}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            
            // Update the timer display
            const timerElement = document.getElementById('timeSpent');
            if (timerElement) {
                timerElement.textContent = formattedTime;
            }
        }
        
        // Handle visibility change
        document.addEventListener('visibilitychange', function() {
            if (document.visibilityState === 'hidden') {
                // User left the page - save the time
                updateTimer();
            } else {
                // User returned - reset start time
                startTime = new Date();
            }
        });
        
        // Save time when leaving the page
        window.addEventListener('beforeunload', function() {
            updateTimer();
        });
        
        // Initialize the timer when the page loads
        document.addEventListener('DOMContentLoaded', initTimer);
        
        // TIME TRACKING - END
        // -----------------------------------------------------------------------
        
        // Get progress data from localStorage
        function loadProgress() {
            const TASK_STORAGE_KEY = 'taskTrackerData';
            const savedData = JSON.parse(localStorage.getItem(TASK_STORAGE_KEY) || '{}');
            
            if (savedData.tasks && savedData.tasks.length > 0) {
                const tasks = savedData.tasks;
                const completedCount = tasks.filter(task => task.completed).length;
                const progressPercentage = Math.round((completedCount / tasks.length) * 100);
                
                document.getElementById('progressFill').style.width = `${progressPercentage}%`;
                document.getElementById('progressFill').textContent = `${progressPercentage}%`;
            } else {
                document.getElementById('progressFill').style.width = '0%';
                document.getElementById('progressFill').textContent = '0%';
            }
        }
        
        // Initialize progress when the page loads
        document.addEventListener('DOMContentLoaded', function() {
            loadProgress();
        });
    </script>
</body>
</html>
